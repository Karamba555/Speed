--- "a/contrib/minizip/miniunz.c"	2022-10-07 05:43:19.000000000 +0200
+++ "b/contrib/minizip/miniunz.c"	2024-10-07 17:43:53.964199534 +0200
@@ -368,6 +368,19 @@
         else
             write_filename = filename_withoutpath;
 
+        if (write_filename[0]!='\0')
+        {
+            const char* relative_check = write_filename;
+            while (relative_check[1]!='\0')
+            {
+                if (relative_check[0]=='.' && relative_check[1]=='.')
+                    write_filename = relative_check;
+                relative_check++;
+            }
+        }
+        while (write_filename[0]=='/' || write_filename[0]=='.')
+            write_filename++;
+
         err = unzOpenCurrentFilePassword(uf,password);
         if (err!=UNZ_OK)
         {
